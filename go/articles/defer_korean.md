<!--
Meta Description: # Go 언어의 defer: 지연 실행의 활용과 이해 ## 개요 Go 언어의 `defer` 키워드는 함수가 종료될 때까지 특정 코드를 지연 실행하는 데 사용됩니다. 이 기능은 리소스를 해제하거나, 파일을 닫거나, 오류를 처리하는 등의 작업을 안전하게 수행하는 데 유용합...
Meta Keywords: defer, 함수가, fmt, 실행됩니다, main
-->

# Go 언어의 defer: 지연 실행의 활용과 이해

## 개요
Go 언어의 `defer` 키워드는 함수가 종료될 때까지 특정 코드를 지연 실행하는 데 사용됩니다. 이 기능은 리소스를 해제하거나, 파일을 닫거나, 오류를 처리하는 등의 작업을 안전하게 수행하는 데 유용합니다.

## 문서화
`defer`는 Go에서 함수 호출을 지연시키는 데 사용되는 키워드입니다. `defer`로 지정된 함수는 현재 함수가 종료될 때까지 실행이 연기됩니다. 여러 개의 `defer` 문이 있을 경우, 가장 나중에 선언된 `defer` 문부터 순차적으로 실행됩니다.

### 사용 목적
- **리소스 관리**: 파일, 네트워크 연결, 데이터베이스 연결 등을 안전하게 닫기 위해 사용합니다.
- **코드 가독성 향상**: 종료 작업을 함수의 시작 부분에서 배치함으로써 코드의 가독성을 높입니다.

### 사용법
`defer` 문은 함수 내에서 사용되며, 다음과 같은 형식으로 작성됩니다:

```go
defer 함수명(인자들)
```

이렇게 선언된 `defer` 문은 외부 함수가 완료될 때까지 대기하며, 해당 함수가 끝나면 지정된 함수가 실행됩니다.

## 예제
다음은 `defer`의 기본 사용 예제입니다.

```go
package main

import (
    "fmt"
)

func main() {
    defer fmt.Println("첫 번째 지연 실행")
    defer fmt.Println("두 번째 지연 실행")

    fmt.Println("메인 함수 실행 중")
}
```

### 출력
```
메인 함수 실행 중
두 번째 지연 실행
첫 번째 지연 실행
```

위 예제에서 볼 수 있듯이, `defer` 문은 메인 함수가 종료된 후에 실행됩니다. 특히 여러 개의 `defer` 문이 있을 경우, 나중에 정의된 `defer` 문이 먼저 실행되는 것을 확인할 수 있습니다.

## 설명
`defer`를 사용할 때 주의해야 할 몇 가지 사항이 있습니다:

- **스코프**: `defer`가 선언된 함수의 스코프 내에서만 유효합니다. 따라서 외부 함수에서 `defer`를 사용하더라도, 해당 함수가 종료되면 더 이상 사용할 수 없습니다.
- **인자 평가**: `defer` 문에서 호출하는 함수의 인자는 `defer` 문이 실행될 때가 아니라 선언될 때 평가됩니다. 즉, `defer` 문 내의 인자가 변경되더라도, 이미 평가된 값을 기반으로 실행됩니다.

예를 들어:

```go
package main

import "fmt"

func main() {
    x := 10
    defer fmt.Println(x) // x의 값이 10으로 평가됨
    x++                  // x의 값이 11로 증가됨
}
```

이 경우 출력은 `10`이 됩니다. `defer` 문이 선언될 당시의 `x` 값이 사용되기 때문입니다.

## 한줄 요약
Go 언어의 `defer` 키워드는 함수 종료 시 특정 코드를 지연 실행하여 리소스를 안전하게 관리할 수 있도록 돕습니다.